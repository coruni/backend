(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-48605a9c"],{c405:function(t,e,r){"use strict";r.d(e,"b",(function(){return o})),r.d(e,"e",(function(){return a})),r.d(e,"c",(function(){return n})),r.d(e,"d",(function(){return s})),r.d(e,"a",(function(){return c}));var i=r("b775");function o(t){return Object(i["a"])({url:"/category/list",method:"get",params:t})}function a(t){return Object(i["a"])({url:"/category/update",method:"post",params:t})}function n(t){return Object(i["a"])({url:"/category/delete",method:"post",params:t})}function s(t){return Object(i["a"])({url:"/category/add",method:"post",params:t})}function c(t){return Object(i["a"])({url:"/category/action",method:"post",params:t})}},e9c4:function(t,e,r){var i=r("23e7"),o=r("d066"),a=r("d039"),n=o("JSON","stringify"),s=/[\uD800-\uDFFF]/g,c=/^[\uD800-\uDBFF]$/,l=/^[\uDC00-\uDFFF]$/,u=function(t,e,r){var i=r.charAt(e-1),o=r.charAt(e+1);return c.test(t)&&!l.test(o)||l.test(t)&&!c.test(i)?"\\u"+t.charCodeAt(0).toString(16):t},m=a((function(){return'"\\udf06\\ud834"'!==n("\udf06\ud834")||'"\\udead"'!==n("\udead")}));n&&i({target:"JSON",stat:!0,forced:m},{stringify:function(t,e,r){var i=n.apply(null,arguments);return"string"==typeof i?i.replace(s,u):i}})},f409:function(t,e,r){"use strict";r.r(e);var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"app-container"},[r("el-form",{attrs:{inline:"",size:"small"}},[r("el-button",{staticStyle:{"margin-right":"3em"},attrs:{type:"success",size:"small",icon:"el-icon-plus"},on:{click:t.onAdd}},[t._v("添加分类 ")])],1),r("el-table",{staticStyle:{width:"100%","border-radius":"5px","margin-top":"20px"},attrs:{data:t.category,size:"mini",border:"","header-cell-style":{background:"#409EFF",color:"#ffffff"}}},[r("el-table-column",{attrs:{prop:"mid",label:"ID",width:"60"}}),r("el-table-column",{attrs:{label:"头像"},scopedSlots:t._u([{key:"default",fn:function(t){return[r("el-image",{staticStyle:{width:"40px",height:"40px"},attrs:{src:t.row.imgurl}})]}}])}),r("el-table-column",{attrs:{prop:"name",label:"分类名"}}),r("el-table-column",{attrs:{prop:"description",label:"介绍"}}),r("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(r){return t.editTap(e.row)}}},[t._v("编辑")]),r("el-button",{staticClass:"red",attrs:{size:"mini",type:"text"},on:{click:function(r){return t.messageNotice(e.row.mid)}}},[t._v("删除")])]}}])})],1),r("el-dialog",{attrs:{title:"分类管理",visible:t.dialogVisible,width:"40%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[r("el-form",{ref:"form",attrs:{size:"small","label-width":"80px"},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}},[r("el-form-item",{attrs:{label:"头像"}},[r("el-upload",{attrs:{action:"/upload/full",beforeAvatarUpload:t.beforeAvatarUpload,"on-success":t.handleAvatarSuccess,headers:{Authorization:t.getToken()},"show-file-list":!1}},[t.form.imgurl?r("el-image",{staticStyle:{width:"80px",height:"80px"},attrs:{src:t.form.imgurl}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1)],1),r("el-form-item",{attrs:{label:"名称"}},[r("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),r("el-form-item",{attrs:{label:"介绍"}},[r("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:6}},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),r("el-form-item",{attrs:{label:"主题色"}},[r("el-input",{model:{value:t.form.opt.primary,callback:function(e){t.$set(t.form.opt,"primary",e)},expression:"form.opt.primary"}})],1),r("el-form-item",{attrs:{label:"下划线"}},[r("el-input",{model:{value:t.form.opt.underline,callback:function(e){t.$set(t.form.opt,"underline",e)},expression:"form.opt.underline"}})],1),r("el-form-item",{attrs:{label:"文字颜色"}},[r("el-input",{model:{value:t.form.opt.color,callback:function(e){t.$set(t.form.opt,"color",e)},expression:"form.opt.color"}})],1),r("el-form-item",{attrs:{label:"瀑布流"}},[r("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:function(e){return t.categoryAction("waterfall",t.form.mid)}},model:{value:t.form.iswaterfall,callback:function(e){t.$set(t.form,"iswaterfall",e)},expression:"form.iswaterfall"}})],1),r("el-form-item",{attrs:{label:"首页推荐"}},[r("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:function(e){return t.categoryAction("recommend",t.form.mid)}},model:{value:t.form.isrecommend,callback:function(e){t.$set(t.form,"isrecommend",e)},expression:"form.isrecommend"}})],1),r("el-form-item",{attrs:{label:"发布权限"}},[r("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:function(e){return t.categoryAction("permission",t.form.mid)}},model:{value:t.form.permission,callback:function(e){t.$set(t.form,"permission",e)},expression:"form.permission"}}),r("span",[t._v("(关闭：全员可发，开启：管理员可发)")])],1),r("el-form-item",{attrs:{label:"会员可见"}},[r("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:function(e){return t.categoryAction("vip",t.form.mid)}},model:{value:t.form.isvip,callback:function(e){t.$set(t.form,"isvip",e)},expression:"form.isvip"}})],1)],1),r("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(e){t.form&&t.form.mid?t.update():t.newCategory()}}},[t._v("提交")])],1)],1)},o=[],a=r("5530"),n=r("c7eb"),s=r("1da1"),c=(r("e9c4"),r("b0c0"),r("a4d3"),r("e01a"),r("d3b7"),r("c405")),l=r("5f87"),u={data:function(){return{dialogVisible:!1,form:{mid:0,name:"",description:"",imgurl:"",iswaterfall:0,isrecommend:0,opt:{background:"",color:"",primary:"",underline:""}},category:[],page:1,limit:20,url:null}},created:function(){this.initData(),this.url="/"},methods:{getToken:l["a"],initData:function(){this.getCategory()},getCategory:function(){var t=this,e={page:this.page,limit:this.limit,params:JSON.stringify({type:"category"})};Object(c["b"])(e).then((function(e){t.category=e.data.data}))},handleAvatarSuccess:function(t,e){this.form.imgurl=t.data.url},beforeAvatarUpload:function(t){var e=t.size/1024/1024<2;return e||this.$message.error("上传头像图片大小不能超过 2MB!"),e},onAdd:function(){this.form={mid:0,name:"",description:"",imgurl:"",iswaterfall:0,isrecommend:0,opt:{background:"",color:"",primary:"",underline:""}},this.dialogVisible=!0},update:function(){var t=this,e={id:this.form.mid,name:this.form.name,description:this.form.description,avatar:this.form.imgurl,opt:JSON.stringify(this.form.opt)};Object(c["e"])(e).then((function(e){t.$message({message:"修改成功",type:"success"}),t.resetForm()})),this.getCategory()},resetForm:function(){this.form={name:"",description:"",imgurl:"",opt:{background:"",color:"",primary:"",underline:""}}},deleteCategory:function(t){return new Promise((function(e,r){Object(c["c"])({id:t}).then((function(t){e()}))}))},messageNotice:function(t){var e=this;return Object(s["a"])(Object(n["a"])().mark((function r(){return Object(n["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:e.$confirm("是否删除该分类？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(s["a"])(Object(n["a"])().mark((function r(){return Object(n["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.deleteCategory(t);case 2:e.getCategory(),e.$message({type:"success",message:"删除成功"});case 4:case"end":return r.stop()}}),r)}))));case 1:case"end":return r.stop()}}),r)})))()},editTap:function(t){t=t;t.hasOwnProperty("opt")||(t.opt={background:"",color:"",primary:"",underline:""}),this.form=Object(a["a"])({},t),this.dialogVisible=!0},newCategory:function(){var t=this;if(this.form.name){var e={name:this.form.name,type:"category",description:this.form.description,opt:JSON.stringify(this.form.opt),avatar:this.form.imgurl};Object(c["d"])(e).then((function(e){200==e.code&&(t.$message({type:"success",message:"添加成功"}),t.getCategory(),t.resetForm())}))}},categoryAction:function(t,e){var r=this,i={type:t,id:e};Object(c["a"])(i).then((function(t){200==t.code&&(r.$message({type:"success",message:"设置成功"}),r.getCategory())}))}}},m=u,f=r("2877"),d=Object(f["a"])(m,i,o,!1,null,null,null);e["default"]=d.exports}}]);